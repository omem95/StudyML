# 데이터 불균형 문제 및 해결방법

##### SMOTE Technique이 무엇인지 찾아보다가 데이터 불균형 문제 해결 방법 중 하나라는 것을 알게 되고 다른 방법은 무엇이 있는지 알아보고 정리하게 됨


### 데이터 불균형 문제 개념
--- 
데이터 분석 시 겪을 수 있는 문제 중 하나이다. 각 클래스의 수가 상대적으로 매우 차이나는 경우를 말한다.

### 예시
---
- 암 환자와 일반 사람의 비율
- 신용카드 정상 거래와 사기 거래

### 문제점
---
- 일반적으로 이상 데이터가 target 값인 경우가 많기 때문에 정상 데이터 분류보다 이상 데이터 분류가 중요한데, 이 이상 데이터를 정확히 찾아내지 못할 수 있다.(성능이 떨어질 수 있다)
- 정확도(accuracy)가 높더라도 재현율(recall)은 떨어질 수 있다. 100개 중 A 95, B 5라면 모두 A로 예측해도 정확도는 95%이기 때문.

### 데이터 불균형 문제 처리 방법
---
#### Under Sampling
- 다수인 클래스의 데이터 중 무작위로 일부만 사용해 소수인 클래스와 비슷한 크기로 맞추는 방법
- 장점 : 유의미한 데이터만 남기고 문제를 해결할 수 있다.
- 단점 : 데이터 소실이 매우 크고, 그 중 중요한 데이터도 포함될 수 있다.

1 Random Under Sampling
- 무작위로 다수 데이터를 삭제한다.
- 무작위로 실행되기 때문에 시간이 매우 빠르다는 장점이 있지만 단점이 그대로 나타난다.
- 실행 시 마다 다른 결과를 얻는다는 단점도 존재한다.

2. Tomek Link
- 다른 클래스의 데이터 두 개를 연결하고 주변에 다른 임의의 데이터 Xk가 존재할 때, 연결된 각 데이터와 Xk의 거리보다 연결된 데이터간의 거리가 짧을 때 이를 Tomek Link라고 한다.
- Tomek Link를 찾은 후 다수 클래스의 데이터를 제거하여 분류 경계선을 보다 정확하게 가공하는 방법이다.
- 무작위로 데이터를 삭제하는 Random Under Sampling보다 나은 성능을 보일 수 있으나 제거되는 양이 한정적이기 때문에 큰 효과를 기대하기 힘들다는 단점이 있다.
<br> +) 훈련 세트의 성능은 좋아질 수 있으나 Tomek Link와 같거나 더 가까운 데이터가 추가로 입력된다면 문제가 생기지 않을까? 하는 생각이 들었다.

3. CNN Rule
- 다수 데이터 중 임의로 1개를 선택해 이 1개와 소수 데이터 전체를 두고, 나머지 다수 데이터를 K = 1인 1-NN방식으로 더 가까운 쪽에 임시로 분류시킨 후 정상 분류된 데이터를 제거한다.
- K-NN방식을 사용할 경우 모든 데이터가 소수 데이터로 분류되기 때문에 반드시 1-NN을 사용해야 한다.

4. One Sided Selection
- Tomek Link를 먼저 사용한 후 CNN Rule을 사용하여 가공하는 방법 

5. Edited Nearest Neighbours
- KNN과 유사하며 소수 데이터 주변의 다수 데이터를 제거하는 방법으로 제거 효과가 크지 않다.

6. Neighbourhood Cleansing Rule
- CNN 과 ENN 을 섞은 방법으로 분포가 큰 데이터에 대한 제거 효과가 크진 않지만, 직관적으로 클래스를 나눌 수 있다는 장점이 있다.


#### Over Sampling
- Up Sampling 이라고도 하며 소수 데이터를 다수 데이터와 비슷한 크기로 늘리는 방법
- 장점 : 데이터 손실을 막을 수 있다.
- 단점 : overfitting을 야기하여 새 데이터나 테스트 데이터는 성능이 더 나쁠 수 있다.

1. Random Over Sampling
- 무작위로 소수 데이터를 생성한다.
- 반복 데이터 삽입으로 인한 overfitting 문제가 발생할 수 있다.

2. ADASYN(Adaptive Synthetic Sampling)
- 소수 데이터와 가장 가까운 무작위의 K개의 데이터 사이에 가상의 직선을 그려 직선상에 데이터를 생성하는 방법
- 무작위로 반복되는 Random Over Sampling보다 시간이 오래걸리지만 overfitting 문제를 해결할 수 있다.

3. SMOTE(Synthetic Minority Over-sampling Technique)
- ADASYN과 같은 방법론으로 데이터를 생성하지만 생성된 데이터를 분류 모형에 따라 다르게 분류하는 방법